<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src &mdash; BioSNICAR 2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tests" href="tests.html" />
    <link rel="prev" title="BioSNICAR Functions" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BioSNICAR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theoretical-background.html">Theoretical Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="how-to-use.html">How to Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Configuration Guide for BioSNICAR</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">BioSNICAR Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">src</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-src.adding_doubling_solver">src.adding_doubling_solver module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.bubble_reff_calculator">src.bubble_reff_calculator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#src-classes-module">src.classes module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.column_OPs">src.column_OPs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.display">src.display module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#src-geometric-optics-ice-module">src.geometric_optics_ice module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.mie_coated_water_spheres">src.mie_coated_water_spheres module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.setup_snicar">src.setup_snicar module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.toon_rt_solver">src.toon_rt_solver module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-src.validate_inputs">src.validate_inputs module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tests.html">tests</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BioSNICAR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">BioSNICAR Functions</a> &raquo;</li>
      <li>src</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/src.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="src">
<h1>src<a class="headerlink" href="#src" title="Permalink to this headline"></a></h1>
<section id="module-src.adding_doubling_solver">
<span id="src-adding-doubling-solver-module"></span><h2>src.adding_doubling_solver module<a class="headerlink" href="#module-src.adding_doubling_solver" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.adding_doubling_solver">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">adding_doubling_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#adding_doubling_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.adding_doubling_solver" title="Permalink to this definition"></a></dt>
<dd><p>control function for the adding-doubling solver.</p>
<p>Makes function calls in sequence to generate, then return, an instance of
Outputs class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau</strong> – optical thickness of ice column in m/m</p></li>
<li><p><strong>ssa</strong> – single scattering albedo of ice column (dimensionless)</p></li>
<li><p><strong>g</strong> – asymmetry parameter for ice column</p></li>
<li><p><strong>L_snw</strong> – mass of ice in lg</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Instance of Outputs class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>outputs</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError if violation of conservation of energy detected</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.apply_gaussian_integral">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">apply_gaussian_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lyr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#apply_gaussian_integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.apply_gaussian_integral" title="Permalink to this definition"></a></dt>
<dd><p>Applies gaussian integral to integrate over angles.</p>
<p>Uses gaussien integration to integrate fluxes hemispherically from
N of reference angles where N = len(gauspt) (default is 8).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>exp_min</strong> – small number for avoiding div/0 error</p></li>
<li><p><strong>ts</strong> – delta-scaled extinction optical depth for lyr</p></li>
<li><p><strong>ws</strong> – delta-scaled single scattering albedo for lyr</p></li>
<li><p><strong>gs</strong> – delta-scaled asymmetry parameter for lyr</p></li>
<li><p><strong>epsilon</strong> – small number to avoid singularity</p></li>
<li><p><strong>lm</strong> – lamda for use in delta scaling</p></li>
<li><p><strong>lyr</strong> – integer representing index of current layer (0==top)</p></li>
<li><p><strong>rdif_a</strong> – rdif_a: reflectance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>tdif_a</strong> – rdif_a: transmittance to diffuse energy w polarization state == perpendicular</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accumulator for tdif gaussian integration
smr: accumulator for rdif gaussian integration
swt: sum of gaussian weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>smt</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.apply_smoothing_function">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">apply_smoothing_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#apply_smoothing_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.apply_smoothing_function" title="Permalink to this definition"></a></dt>
<dd><p>Applies Savitsky-Golay smoothing function to albedo, if toggled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>albedo</strong> – array of albedo values, likely passed as outputs.albedo</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.calc_correction_fresnel_layer">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">calc_correction_fresnel_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trnlay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lyr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#calc_correction_fresnel_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.calc_correction_fresnel_layer" title="Permalink to this definition"></a></dt>
<dd><p>Calculates correction for Fresnel reflection and total internal reflection.</p>
<p>Corrects fluxes for Fresnel reflection in cases where total
internal reflection does and does not occur (angle &gt; critical_angle).
In TIR case fluxes are precalculated because ~256 gaussian points required
for convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>mu0n</strong> – incidence angle for direct beam adjusted for refraction</p></li>
<li><p><strong>mu0</strong> – incidence angle of direct beam at upper surface</p></li>
<li><p><strong>nr</strong> – real part of refractive index</p></li>
<li><p><strong>rdif_a</strong> – reflectance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>rdif_b</strong> – reflectance to diffuse energy w polarization state == parallel</p></li>
<li><p><strong>tdif_a</strong> – transmittance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>tdif_b</strong> – transmittance to diffuse energy w polarization state == parallel</p></li>
<li><p><strong>trnlay</strong> – transmission of layer == lyr</p></li>
<li><p><strong>lyr</strong> – current layer (0 ==top)</p></li>
<li><p><strong>rdir</strong> – reflectance to direct beam</p></li>
<li><p><strong>tdir</strong> – transmission of direct beam</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated reflectance to diffuse energy w polarization state == perpendicular
rdif_b: updated reflectance to diffuse energy w polarization state == parallel
tdif_a: updated transmittance to diffuse energy w polarization state == perpendicular
tdif_b: updated transmittance to diffuse energy w polarization state == parallel
trnlay: updated transmission of layer == lyr
rdir: updated reflectance to direct beam
tdir: updated transmission of direct beam</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdif_a</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.calc_reflection_below">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">calc_reflection_below</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trnlay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#calc_reflection_below"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.calc_reflection_below" title="Permalink to this definition"></a></dt>
<dd><p>Calculates dir/diff reflectyivity for layers below surface.</p>
<p>Compute reflectivity to direct (rupdir) and diffuse (rupdif) radiation
for layers below by adding succesive layers starting from the
underlying ice and working upwards:</p>
<blockquote>
<div><blockquote>
<div><p>layers       interface</p>
</div></blockquote>
<dl class="simple">
<dt>———————  lyr</dt><dd><p>lyr</p>
</dd>
<dt>———————  lyr+1</dt><dd><p>lyr+1</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>rdif_a</strong> – reflectance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>rdif_b</strong> – reflectance to diffuse energy w polarization state == parallel</p></li>
<li><p><strong>tdif_a</strong> – transmittance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>tdif_b</strong> – transmittance to diffuse energy w polarization state == parallel</p></li>
<li><p><strong>trnlay</strong> – transmission of layer == lyr</p></li>
<li><p><strong>rdir</strong> – reflectance to direct beam</p></li>
<li><p><strong>tdir</strong> – transmission of direct beam</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>upwards flux direct
rupdif: upwards flux diffuse</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rupdir</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.calc_reflection_transmission_from_top">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">calc_reflection_transmission_from_top</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lyr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trnlay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#calc_reflection_transmission_from_top"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.calc_reflection_transmission_from_top" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the reflection and transmission of energy at top surfaces.</p>
<p>Calculate the solar beam transmission, total transmission, and
reflectivity for diffuse radiation from below at interface lyr,
the top of the current layer lyr:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>layers       interface</p>
</div></blockquote>
<dl class="simple">
<dt>———————  lyr-1</dt><dd><p>lyr-1</p>
</dd>
<dt>———————  lyr</dt><dd><p>lyr</p>
</dd>
</dl>
</div></blockquote>
<p>note that we ignore refraction between sea ice and underlying substrate:</p>
<blockquote>
<div><blockquote>
<div><p>layers       interface</p>
</div></blockquote>
<dl class="simple">
<dt>———————  lyr-1</dt><dd><p>lyr-1</p>
</dd>
</dl>
<p>———————  lyr
\\ R_sfc \</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lyr</strong> – integer representing the index of the current layer (0 at top)</p></li>
<li><p><strong>trnlay</strong> – transmissivity of current layer</p></li>
<li><p><strong>rdif_a</strong> – reflectivity to diffuse irradiance at polarization state == perpendicular</p></li>
<li><p><strong>rdir</strong> – reflectivity to direct beam</p></li>
<li><p><strong>tdif_a</strong> – transmissivity to diffuse irradiance at polarization state == perpendicular</p></li>
<li><p><strong>rdif_b</strong> – reflectivity to diffuse irradiance at polarization state == parallel</p></li>
<li><p><strong>tdir</strong> – transmissivity to direct beam</p></li>
<li><p><strong>tdif_b</strong> – transmissivity to diffuse irradiance at polarization state == parallel</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>transmission of direct beam
trntdr: total transmission of direct beam for all layers above current layer
rdndif: downwards diffuse reflectance
trndif: diffuse transmission</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>trndir</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.calc_reflectivity_transmittivity">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">calc_reflectivity_transmittivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lyr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trnlay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#calc_reflectivity_transmittivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.calc_reflectivity_transmittivity" title="Permalink to this definition"></a></dt>
<dd><p>Calculates reflectivity and transmissivity.</p>
<p>Sets up new variables, applies delta transformation and makes
initial calculations of reflectivity and transmissivity in each
layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau0</strong> – initial optical thickness</p></li>
<li><p><strong>ssa0</strong> – initial single scattering albedo</p></li>
<li><p><strong>g0</strong> – initial asymmetry parameter</p></li>
<li><p><strong>lyr</strong> – index of current layer</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>exp_min</strong> – small number to avoid /zero error</p></li>
<li><p><strong>rdif_a</strong> – reflectivity to diffuse irradiance at polarization angle == perpendicular</p></li>
<li><p><strong>tdif_a</strong> – transmissivity to diffuse irradiance at polarization angle == perpendicular</p></li>
<li><p><strong>trnlay</strong> – transmission through layer</p></li>
<li><p><strong>mu0n</strong> – incident beam angle adjusted for refraction</p></li>
<li><p><strong>epsilon</strong> – small number to avoid singularity</p></li>
<li><p><strong>rdir</strong> – reflectivity to direct beam</p></li>
<li><p><strong>tdir</strong> – transmissivity to direct beam</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.calculate_fluxes">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">calculate_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdirup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdifup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdirdn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdifdn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#calculate_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.calculate_fluxes" title="Permalink to this definition"></a></dt>
<dd><p>Calculates total fluxes in each layer and for entire column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>fdirup</strong> – upwards flux of direct radiation</p></li>
<li><p><strong>fdifup</strong> – upwards flux od diffuse radiation</p></li>
<li><p><strong>fdirdn</strong> – downwards flux of direct radiation</p></li>
<li><p><strong>fdifdn</strong> – downwards flux of diffuse radiation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ratio of upwards fluxes to incoming irradiance
F_abs: absorbed flux in each layer
F_btm_net: net fluxes at bottom surface
F_top_pls: upwards flux from upper surface</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>albedo</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.conservation_of_energy_check">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">conservation_of_energy_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_abs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_btm_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_top_pls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#conservation_of_energy_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.conservation_of_energy_check" title="Permalink to this definition"></a></dt>
<dd><p>Checks there is no conservation of energy violation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>F_abs</strong> – absorbed flux in each layer</p></li>
<li><p><strong>F_btm_net</strong> – net flux at bottom surface</p></li>
<li><p><strong>F_top_pls</strong> – upwards flux from upper boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError is conservation of energy error is detected</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.define_constants_arrays">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">define_constants_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#define_constants_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.define_constants_arrays" title="Permalink to this definition"></a></dt>
<dd><p>defines and instantiates constants required for a-d calculations.</p>
<p>Defines and instantiates all variables required for calculating energy fluxes
using the adding-doubling method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau</strong> – optical thickness of ice column in m/m</p></li>
<li><p><strong>g</strong> – asymmetry parameter for ice column</p></li>
<li><p><strong>ssa</strong> – single scattering albedo of ice column (dimensionless)</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>initial optical thickness (m/m)
g0: initial asymmetry parameter (dimensionless)
ssa0: initial single scatterign albedo (dimensionless)
epsilon: small number to avoid singularity
exp_min: small number to avoid zero calcs
nr: real part of refractive index
mu0: cosine of direct beam zenith angle
mu0n: adjusted cosine of direct beam zenith angle after refraction
trnlay: transmission through layer
rdif_a: reflectivity to diffuse irradiance at polarization angle == perpendicular
rdif_b: reflectivity to diffuse irradiance at polarization angle == parallel
tdif_a: transmissivity to diffuse irradiance at polarization angle == perpendicular
tdif_b: transmissivity to diffuse irradiance at polarization angle == parallel
rdir: reflectivity to direct beam
tdir: transmissivity to direct beam
lyrfrsnl: index of uppermost fresnel reflecting layer in ice column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tau0</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.get_outputs">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">get_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_abs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_btm_net</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#get_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.get_outputs" title="Permalink to this definition"></a></dt>
<dd><p>Assimilates useful data into instance of Outputs class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>albedo</strong> – ratio of upwwards fluxes and irradiance</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>L_snw</strong> – mass of ice in each layer</p></li>
<li><p><strong>F_abs</strong> – absorbed flux in each layer</p></li>
<li><p><strong>F_btm_net</strong> – net flux at bottom surface</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance of Outputs class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.trans_refl_at_interfaces">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">trans_refl_at_interfaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rupdif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rupdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdndif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trndir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trndif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trntdr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#trans_refl_at_interfaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.trans_refl_at_interfaces" title="Permalink to this definition"></a></dt>
<dd><p>Calculates transmission and reflection at layer interfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>rupdif</strong> – total diffuse radiation reflected upwards</p></li>
<li><p><strong>rupdir</strong> – total direct radiation reflected upwards</p></li>
<li><p><strong>rdndif</strong> – downwards reflection of diffuse radiation</p></li>
<li><p><strong>trndir</strong> – transmission of direct radiation</p></li>
<li><p><strong>trndif</strong> – transmission of diffuse radiation</p></li>
<li><p><strong>trntdr</strong> – total transmission</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>upwards flux of direct radiation
fdifup: upwards flux of diffuse radiation
fdirdn: downwards flux of direct radiation
fdifdn: downwards flux of diffuse radiation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fdirup</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.adding_doubling_solver.update_transmittivity_reflectivity">
<span class="sig-prename descclassname"><span class="pre">src.adding_doubling_solver.</span></span><span class="sig-name descname"><span class="pre">update_transmittivity_reflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lyr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdif_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdif_b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/adding_doubling_solver.html#update_transmittivity_reflectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.adding_doubling_solver.update_transmittivity_reflectivity" title="Permalink to this definition"></a></dt>
<dd><p>updates transmissivity and reflectivity values after iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swt</strong> – sum of gaussian weights (for integrating over angle)</p></li>
<li><p><strong>smr</strong> – accumulator for rdif gaussian integration</p></li>
<li><p><strong>smt</strong> – accumulator for tdif gaussian integration</p></li>
<li><p><strong>lyr</strong> – integer representign index of current layer (0 == top)</p></li>
<li><p><strong>rdif_a</strong> – reflectance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>rdif_b</strong> – reflectance to diffuse energy w polarization state == parallel</p></li>
<li><p><strong>tdif_a</strong> – transmittance to diffuse energy w polarization state == perpendicular</p></li>
<li><p><strong>tdif_b</strong> – transmittance to diffuse energy w polarization state == parallel</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated reflectance to diffuse energy w polarization state == perpendicular
rdif_b: updated reflectance to diffuse energy w polarization state == parallel
tdif_a: updated transmittance to diffuse energy w polarization state == perpendicular
tdif_b: updated transmittance to diffuse energy w polarization state == parallel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdif_a</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.bubble_reff_calculator">
<span id="src-bubble-reff-calculator-module"></span><h2>src.bubble_reff_calculator module<a class="headerlink" href="#module-src.bubble_reff_calculator" title="Permalink to this headline"></a></h2>
<p>Calculates effective radius of air bubbles.</p>
<p>This script is for taking specific surface area for bubbly ice an calculating the
effective radius of the bubbles assuming a lognormal bubble size distribution.</p>
<p>The reason this is required is that the well-known conversion between SSA and r_eff:</p>
<p>r_eff = 3/(P_i * SSA) where P_i is density of ice (917 kg m-3)</p>
<p>gives the effective radius of a discrete grain of given SSA, for a collection of bubbles
in a bulk medium of ice a more nuanced calculation is required.</p>
<p>The derivation of the calculations are explained in the pdf ./assets/SSA_derivation.pdf
from Chloe Whicker (UMich).</p>
</section>
<section id="src-classes-module">
<h2>src.classes module<a class="headerlink" href="#src-classes-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-src.column_OPs">
<span id="src-column-ops-module"></span><h2>src.column_OPs module<a class="headerlink" href="#module-src.column_OPs" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.column_OPs.add_water_coating">
<span class="sig-prename descclassname"><span class="pre">src.column_OPs.</span></span><span class="sig-name descname"><span class="pre">add_water_coating</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mac_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/column_OPs.html#add_water_coating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.column_OPs.add_water_coating" title="Permalink to this definition"></a></dt>
<dd><p>Recalculates layer optical properties where grains are coated in liquid water.</p>
<p>Feature originally added by Niklas Bohn. Where value of water exceeds value of rds
for a given layer it is interpreted as having a liquid water film. in this case
Mie calculations for a coated sphere are executed with the outer coating havign radius
water - rds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>ssa_snw</strong> – single scattering albedo of each layer</p></li>
<li><p><strong>g_snw</strong> – asymmetry parameter for each layer</p></li>
<li><p><strong>mac_snw</strong> – mass absorption coefficient of each layer</p></li>
<li><p><strong>i</strong> – layer counter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated single scattering albedo for each layer
g_snw: updated asymmetry parameter for each layer
mac_snw: updated mass absorption coefficient for each layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ssa_snw</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError if ice.shp!= 0</strong><strong> (</strong><strong>i.e. grains not spherical</strong><strong>)</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.column_OPs.correct_for_asphericity">
<span class="sig-prename descclassname"><span class="pre">src.column_OPs.</span></span><span class="sig-name descname"><span class="pre">correct_for_asphericity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/column_OPs.html#correct_for_asphericity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.column_OPs.correct_for_asphericity" title="Permalink to this definition"></a></dt>
<dd><p>Adjusts asymmetry parameter for aspherical grains.</p>
<p>Implements work from Fu et al. 2007 and He et al. 2017.
Asymmetry parameter is adjusted to account for asphericity
for the defined shape of each layer.</p>
<p>Ice grain shape can be
0 = sphere,
1 = spheroid,
2 = hexagonal plate,
3 = koch snowflake,
4 = hexagonal prisms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>g_snw</strong> – asymmetry parameter for each layer</p></li>
<li><p><strong>i</strong> – layer counter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated asymmetry parameter for layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>g_snw</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.column_OPs.get_layer_OPs">
<span class="sig-prename descclassname"><span class="pre">src.column_OPs.</span></span><span class="sig-name descname"><span class="pre">get_layer_OPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/column_OPs.html#get_layer_OPs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.column_OPs.get_layer_OPs" title="Permalink to this definition"></a></dt>
<dd><p>Calculates optical properties (tauy, ssa, g) of ice column.</p>
<p>Takes configuration from ice and model_config and uses the data
to calculate the optical properties of the ice column. There are
separate routes for layers with granular ice and solid ice.
Function calls are made to add liquid water coatings or adjust
the optical properties for aspherical grains where toggled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>single scatterign albedo of each layer
g_snw: asymmetry parameter of each layer
mac_snw: mass absorption coefficient of each layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ssa_snw</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.column_OPs.mix_in_impurities">
<span class="sig-prename descclassname"><span class="pre">src.column_OPs.</span></span><span class="sig-name descname"><span class="pre">mix_in_impurities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ssa_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mac_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impurities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/column_OPs.html#mix_in_impurities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.column_OPs.mix_in_impurities" title="Permalink to this definition"></a></dt>
<dd><p>Updates optical properties for the presence of light absorbing particles.</p>
<p>Takes the optical properties of the clean ice column and adjusts them for
the presence of light absorbing particles in the ice. Each impurity is an
instance of the Impurity class whose attributes include the path to the
specific optical properties for that impurity. Its concentration is generally
provided in ppb, but concentration of algae can also be given in cells/mL.</p>
<p>There is also a cfactor attribute that is used as a multiplier in this
function. This is a “concentrating factor” that can be applied to account
for the coarse resolution of field sampling compared to the fine resolution
of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ssa_snw</strong> – single scattering albedo of eahc layer</p></li>
<li><p><strong>g_snw</strong> – asymmetry parameter for each layer</p></li>
<li><p><strong>mac_snw</strong> – mass absorption coefficient of each layer</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>impurities</strong> – array containing instances of Impurity class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated optical thickness
ssa: updated single scattering albedo
g: updated asymmetry parameter
L_snw: mass of ice ine ach layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tau</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.display">
<span id="src-display-module"></span><h2>src.display module<a class="headerlink" href="#module-src.display" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.display.calculate_band_ratios">
<span class="sig-prename descclassname"><span class="pre">src.display.</span></span><span class="sig-name descname"><span class="pre">calculate_band_ratios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/display.html#calculate_band_ratios"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.display.calculate_band_ratios" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.display.display_out_data">
<span class="sig-prename descclassname"><span class="pre">src.display.</span></span><span class="sig-name descname"><span class="pre">display_out_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/display.html#display_out_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.display.display_out_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.display.plot_albedo">
<span class="sig-prename descclassname"><span class="pre">src.display.</span></span><span class="sig-name descname"><span class="pre">plot_albedo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/display.html#plot_albedo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.display.plot_albedo" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.display.setup_axes">
<span class="sig-prename descclassname"><span class="pre">src.display.</span></span><span class="sig-name descname"><span class="pre">setup_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/display.html#setup_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.display.setup_axes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="src-geometric-optics-ice-module">
<h2>src.geometric_optics_ice module<a class="headerlink" href="#src-geometric-optics-ice-module" title="Permalink to this headline"></a></h2>
</section>
<section id="module-src.mie_coated_water_spheres">
<span id="src-mie-coated-water-spheres-module"></span><h2>src.mie_coated_water_spheres module<a class="headerlink" href="#module-src.mie_coated_water_spheres" title="Permalink to this headline"></a></h2>
<p>Copyright (C) 2020  Niklas Bohn (GFZ, &lt;<a class="reference external" href="mailto:nbohn&#37;&#52;&#48;gfz-potsdam&#46;de">nbohn<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>&gt;),
German Research Centre for Geosciences (GFZ, &lt;<a class="reference external" href="https://www.gfz-potsdam.de">https://www.gfz-potsdam.de</a>&gt;)</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.mie_coated_water_spheres.fill_nans_scipy1">
<span class="sig-prename descclassname"><span class="pre">src.mie_coated_water_spheres.</span></span><span class="sig-name descname"><span class="pre">fill_nans_scipy1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">padata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pkind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nearest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mie_coated_water_spheres.html#fill_nans_scipy1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mie_coated_water_spheres.fill_nans_scipy1" title="Permalink to this definition"></a></dt>
<dd><p>Interpolates data to fill nan values.</p>
<p>Args:
padata: source data with np.NaN values
pkind:  kind of interpolation (see scipy.interpolate.interp1d docs)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>data with interpolated values instead of nans</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>f(aindexes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mie_coated_water_spheres.miecoated">
<span class="sig-prename descclassname"><span class="pre">src.mie_coated_water_spheres.</span></span><span class="sig-name descname"><span class="pre">miecoated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mie_coated_water_spheres.html#miecoated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mie_coated_water_spheres.miecoated" title="Permalink to this definition"></a></dt>
<dd><p>Mie Efficiencies of coated spheres.</p>
<p>Calculates Mie efficiencies for given complex refractive-index
ratios m1=m1’+im1”, m2= m2’+im2” of kernel
and coating, resp., and size parameters x=k0*a, y=k0*b where
k0 = wave number in ambient  medium, a,b = inner,
outer sphere radius, using complex Mie Coefficients an and bn for
n=1 to nmax, s. Bohren and Huffman (1983)
BEWI:TDD122, p. 181-185,483.</p>
<p>opt selects the function “Miecoated_ab..” for an and bn, n=1 to nmax.</p>
<p>Note that 0&lt;=x&lt;=y (Matzler, 2002).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m1</strong> – refractive-index ratio of kernel</p></li>
<li><p><strong>m2</strong> – refractive-index ratio of coating</p></li>
<li><p><strong>x</strong> – size parameter for inner sphere</p></li>
<li><p><strong>y</strong> – size parameter for outer sphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>extinction efficiency
qsca: scatterign efficiency
qb: backscattering efficiency
asy: asymmetry parameter
qratio: qb/qsca</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>qext</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mie_coated_water_spheres.miecoated_ab3">
<span class="sig-prename descclassname"><span class="pre">src.mie_coated_water_spheres.</span></span><span class="sig-name descname"><span class="pre">miecoated_ab3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mie_coated_water_spheres.html#miecoated_ab3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mie_coated_water_spheres.miecoated_ab3" title="Permalink to this definition"></a></dt>
<dd><p>Computation of Mie Coefficients.</p>
<p>Computes a_n, b_n, of orders n=1 to nmax, complex
refractive index m=m’+im”, and size parameters
x=k0*a, y=k0*b where k0 = wave number in the ambient medium for
coated spheres, a = inner radius, b = outer radius
m1, m2 = inner, outer refractive index;</p>
<p>p. 183 in Bohren and Huffman (1983) BEWI:TDD122 but
using the bottom equation on p. 483 for chi_prime (Matzler 2002).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m1</strong> – refractive index for inner sphere</p></li>
<li><p><strong>m2</strong> – refractive index for outher sphere</p></li>
<li><p><strong>x</strong> – size parameter for inner sphere</p></li>
<li><p><strong>y</strong> – size parameter for outer sphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mie Coefficients a_n and b_n</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.mie_coated_water_spheres.miecoated_driver">
<span class="sig-prename descclassname"><span class="pre">src.mie_coated_water_spheres.</span></span><span class="sig-name descname"><span class="pre">miecoated_driver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rwater</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf_ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_water</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/mie_coated_water_spheres.html#miecoated_driver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.mie_coated_water_spheres.miecoated_driver" title="Permalink to this definition"></a></dt>
<dd><p>Driver for miecoated.</p>
<p>Originally written by Christian Matzler
(see Matzler, 2002). The driver convolves the efficiency factors with the particle
dimensions to return the cross sections for extinction, scattering and
absorption plus the asymmetry parameter, q ratio and single scattering albedo.</p>
<p>Note that the code includes an interpolation regime. This is because the original
code produced NaNs for a few wavelengths at certain size parameters, particularly
in the mid NIR wavelengths.</p>
<p>Adapted from Matlab code by Joseph Cook, University of Sheffield, UK (2017).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rice</strong> – inner sphere diameter in microns</p></li>
<li><p><strong>rwater</strong> – outer sphere diameter in microns (i.e. total coated sphere,
not water layer thickness)</p></li>
<li><p><strong>fn_ice</strong> – path to csv file containing refractive index of ice (Warren, 1984)</p></li>
<li><p><strong>fn_water</strong> – path to csv file containing refractive index of liquid water
(Segelstein, 1981)</p></li>
<li><p><strong>wvl</strong> – wavelength which should be calculated (in microns)</p></li>
<li><p><strong>Returns</strong> – res: tuple containing cross sections for extinction, scattering and
absorption plus the asymmetry parameter, q ratio and single scattering
albedo</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.setup_snicar">
<span id="src-setup-snicar-module"></span><h2>src.setup_snicar module<a class="headerlink" href="#module-src.setup_snicar" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.setup_snicar.build_classes">
<span class="sig-prename descclassname"><span class="pre">src.setup_snicar.</span></span><span class="sig-name descname"><span class="pre">build_classes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/setup_snicar.html#build_classes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.setup_snicar.build_classes" title="Permalink to this definition"></a></dt>
<dd><p>Instantiates classes according to config in yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance of Ice class
illumination: instance of Illumination class
rt_config: instance of RTConfig class
model_config: instance of ModelConfig class
plot_config: instance of PlotConfig class
display_config: instance of DisplayConfig class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ice</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.setup_snicar.build_impurities_array">
<span class="sig-prename descclassname"><span class="pre">src.setup_snicar.</span></span><span class="sig-name descname"><span class="pre">build_impurities_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/setup_snicar.html#build_impurities_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.setup_snicar.build_impurities_array" title="Permalink to this definition"></a></dt>
<dd><p>Creates an array of instances of Impurity.</p>
<p>creates an array of impurities - each one an instance of Impurity with
properties defined in yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of instances of Impurity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>impurities</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.setup_snicar.setup_snicar">
<span class="sig-prename descclassname"><span class="pre">src.setup_snicar.</span></span><span class="sig-name descname"><span class="pre">setup_snicar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/setup_snicar.html#setup_snicar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.setup_snicar.setup_snicar" title="Permalink to this definition"></a></dt>
<dd><p>Builds impurity array and instances of all classes according to config in yaml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance of Ice class
illumination: instance of Illumination class
rt_config: instance of RTConfig class
model_config: instance of ModelConfig class
plot_config: instance of PlotConfig class
display_config: instance of DisplayConfig class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ice</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.toon_rt_solver">
<span id="src-toon-rt-solver-module"></span><h2>src.toon_rt_solver module<a class="headerlink" href="#module-src.toon_rt_solver" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.absorbed_fluxes">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">absorbed_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_top_net</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#absorbed_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.absorbed_fluxes" title="Permalink to this definition"></a></dt>
<dd><p>Calculates energy absorbed in each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>F_net</strong> – net flux in each layer</p></li>
<li><p><strong>F_top_net</strong> – net flux at upper model boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>absorbed flux in each layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>F_abs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.apply_smoothing_function">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">apply_smoothing_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">albedo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#apply_smoothing_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.apply_smoothing_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.boundary_condition">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">boundary_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_clm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#boundary_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.boundary_condition" title="Permalink to this definition"></a></dt>
<dd><p>Calculates reflectance from underlying surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>tau_clm</strong> – optical thickness of column</p></li>
<li><p><strong>tau_star</strong> – delta_scaled optical thickness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reflectance from underlying surface</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>S_sfc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.c_functions">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">c_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_clm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#c_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.c_functions" title="Permalink to this definition"></a></dt>
<dd><p>Calculate fluxes through column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>ssa_star</strong> – delta scaled single scatterign albedo</p></li>
<li><p><strong>tau_star</strong> – delta scaled optical thickness</p></li>
<li><p><strong>tau_clm</strong> – column optical thickness</p></li>
<li><p><strong>lam</strong> – coefficient for matrix solution</p></li>
<li><p><strong>gamma1</strong> – coefficient for matrix solution</p></li>
<li><p><strong>gamma2</strong> – coefficient for matrix solution</p></li>
<li><p><strong>gamma3</strong> – coefficient for matrix solution</p></li>
<li><p><strong>gamma4</strong> – coefficient for matrix solution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>upwards flux from bottom of layer
C_mns_btm: downwards flux from bottom of layer
C_pls_top: upwards flux from top of layer
C_mns_top: downwards flux from top of layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>C_pls_btm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.calculate_matrix_coefficients">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">calculate_matrix_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#calculate_matrix_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.calculate_matrix_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>calculates coefficients required for matrix calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma1</strong> – coefficient for matrix solution</p></li>
<li><p><strong>gamma2</strong> – coefficient for matrix solution</p></li>
<li><p><strong>tau_star</strong> – delta scaled optical thickness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient for matrix solution
GAMMA: coefficient for matrix solution
e1: coefficient for matrix solution
e2: coefficient for matrix solution
e3: coefficient for matrix solution
e4: coefficient for matrix solution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lam</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.calculate_optical_depth_of_column">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">calculate_optical_depth_of_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#calculate_optical_depth_of_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.calculate_optical_depth_of_column" title="Permalink to this definition"></a></dt>
<dd><p>Calculates colum,n optical thickness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>tau_star</strong> – delta scaled optical thickness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>optical thickness of column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tau_clm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.conservation_of_energy_check">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">conservation_of_energy_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_abs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_btm_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_top_pls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#conservation_of_energy_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.conservation_of_energy_check" title="Permalink to this definition"></a></dt>
<dd><p>Checks there is no conservation of energy violation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>F_abs</strong> – absorbed flux in each layer</p></li>
<li><p><strong>F_btm_net</strong> – net flux at bottom surface</p></li>
<li><p><strong>F_top_pls</strong> – upwards flux from upper boundary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError is conservation of energy error is detected</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.delta_transformation">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">delta_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rt_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#delta_transformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.delta_transformation" title="Permalink to this definition"></a></dt>
<dd><p>Applied Delta transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rt_config</strong> – instance of RTConfig class</p></li>
<li><p><strong>g</strong> – asymmetry parameter</p></li>
<li><p><strong>ssa</strong> – single scatterign albedo</p></li>
<li><p><strong>tau</strong> – optical thickness</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>delta scaled asymmetry parameter
ssa_star: delta scaled singloe scattering albedo
tau_star: delta scaled optical thickness</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>g_star</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.get_outputs">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">get_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_top_pls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_top_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_btm_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_abs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_snw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#get_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.get_outputs" title="Permalink to this definition"></a></dt>
<dd><p>Assimilates useful data into instance of Outputs class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>albedo</strong> – ratio of upwwards fluxes and irradiance</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>L_snw</strong> – mass of ice in each layer</p></li>
<li><p><strong>F_abs</strong> – absorbed flux in each layer</p></li>
<li><p><strong>F_btm_net</strong> – net flux at bottom surface</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance of Outputs class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.layer_fluxes">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">layer_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_clm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GAMMA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_pls_btm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_mns_btm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_pls_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_mns_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_one</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#layer_fluxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.layer_fluxes" title="Permalink to this definition"></a></dt>
<dd><p>Calculate total fluxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>tau_clm</strong> – optical thickness of column</p></li>
<li><p><strong>lam</strong> – intermediate coefficient</p></li>
<li><p><strong>GAMMA</strong> – intermediate coefficient</p></li>
<li><p><strong>tau_star</strong> – delta scaled optical thickness</p></li>
<li><p><strong>C_pls_btm</strong> – upwards flux from bottom of layer</p></li>
<li><p><strong>C_mns_btm</strong> – downwards flux from bottom of layer</p></li>
<li><p><strong>C_pls_top</strong> – upwards flux from top of layer</p></li>
<li><p><strong>C_mns_top</strong> – downwards flux from top of layer</p></li>
<li><p><strong>e1</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e2</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e3</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e4</strong> – coefficient for matrix solution</p></li>
<li><p><strong>mu_one</strong> – adjusted indicence angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>net flux in each layer
F_top_pls: net upwards flux from upper surface of each layer
F_btm_net: net flux at bottom surface
F_top_net: net fluxes at upper surface
intensity: mean intensity at base of each layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>F_net</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.matrix_solver">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">matrix_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_sfc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_pls_btm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_mns_btm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_pls_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_mns_top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#matrix_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.matrix_solver" title="Permalink to this definition"></a></dt>
<dd><p>Execute matrix calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>s_sfc</strong> – reflectance of underlying surface</p></li>
<li><p><strong>C_pls_btm</strong> – upwards flux from bottom of layer</p></li>
<li><p><strong>C_mns_btm</strong> – downwards flux from bottom of layer</p></li>
<li><p><strong>C_pls_top</strong> – upwards flux from top of layer</p></li>
<li><p><strong>C_mns_top</strong> – downwards flux from top of layer</p></li>
<li><p><strong>e1</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e2</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e3</strong> – coefficient for matrix solution</p></li>
<li><p><strong>e4</strong> – coefficient for matrix solution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>intermediate representing t-0boundary fluxes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.toon_solver">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">toon_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_snw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#toon_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.toon_solver" title="Permalink to this definition"></a></dt>
<dd><p>Driver func for toon radiative transfer solver.</p>
<p>Makes function calls relating to radiative transfer solver in sequence and returns outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau</strong> – optical thickness</p></li>
<li><p><strong>ssa</strong> – single scattering albedo</p></li>
<li><p><strong>g</strong> – asymmetry parameter</p></li>
<li><p><strong>L_snw</strong> – mass of ice in each layer</p></li>
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>rt_config</strong> – instance of RTConfig class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>instance of Outputs class</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>outputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.two_stream_approximation">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">two_stream_approximation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rt_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssa_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#two_stream_approximation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.two_stream_approximation" title="Permalink to this definition"></a></dt>
<dd><p>Applies two-stream approximation.</p>
<p>Three 2-stream approximations are available: Eddington,
Quadrature and hemispheric mean. The equations for each
approximation are provided in Toon et al. (1989) Table 1.</p>
<p>The hemispheric mean scheme is derived by assuming that the
phase function is equal to 1  + g  in the forward scattering
hemisphere and to 1  - g  in the backward scattering hemisphere.
The asymmetry parameter is g. The hemispheric mean is only
useful for infrared wavelengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rt_config</strong> – instance of RTConfig class</p></li>
<li><p><strong>ssa_star</strong> – delta scaled signle scattering albedo</p></li>
<li><p><strong>g_star</strong> – delta scaled asymmetry parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient for matrix solution
gamma2: coefficient for matrix solution
gamma3: coefficient for matrix solution
gamma4: coefficient for matrix solution
mu_one: adjusted incidence angle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gamma1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.toon_rt_solver.validate_inputs_toon">
<span class="sig-prename descclassname"><span class="pre">src.toon_rt_solver.</span></span><span class="sig-name descname"><span class="pre">validate_inputs_toon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/toon_rt_solver.html#validate_inputs_toon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.toon_rt_solver.validate_inputs_toon" title="Permalink to this definition"></a></dt>
<dd><p>Checks input parameters are valid for Toon solver.</p>
<p>Checks for known invalid data configurations that break the Toon solver.
If invalid config is detected a ValueError is raised, halting execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – class representing the ice column and containing related physical constants</p></li>
<li><p><strong>illumination</strong> – class representing incoming irradiance containing related physical constants</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – raised with descriptive error message if invalid input detected</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.validate_inputs">
<span id="src-validate-inputs-module"></span><h2>src.validate_inputs module<a class="headerlink" href="#module-src.validate_inputs" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_glacier_algae">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_glacier_algae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">impurities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_glacier_algae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_glacier_algae" title="Permalink to this definition"></a></dt>
<dd><p>Validates snow algae configuration.
This includes warning the user that OPs are from literature and not yet field validated.
Most importantly, checks that the units of the absorption coefficient and the cell
concentration match up (m2/cell -&gt; cells/mL, m2/mg -&gt; ppb)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>impurities</strong> – a list of Impurity objects</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError when units mismatch</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_ice">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_ice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_ice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_ice" title="Permalink to this definition"></a></dt>
<dd><p>Validates ice configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ice</strong> – a class containing ice physical constants</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError when lengths of variables are not equal</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_illumination">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_illumination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_illumination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_illumination" title="Permalink to this definition"></a></dt>
<dd><p>Validates illumination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>illumination</strong> – a list of Impurity objects</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError when SZA</strong><strong> or </strong><strong>nbr_wvl outside valid range</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_inputs">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illumination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impurities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Checks all config to make sure all inputs are valid by calling out to:
validate_snow_algae()
validate_ilumination()
validate_ice()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ice</strong> – instance of Ice class</p></li>
<li><p><strong>rt_config</strong> – instance of RTConfig class</p></li>
<li><p><strong>model_config</strong> – instance of ModelConfig class</p></li>
<li><p><strong>illumination</strong> – instance of Illumination class</p></li>
<li><p><strong>impurities</strong> – list of instances of Impurity class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_model_config">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_model_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_model_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_model_config" title="Permalink to this definition"></a></dt>
<dd><p>Validates model configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_config</strong> – a class containing model config variables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError when wavelengths are incorrect</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.validate_inputs.validate_snow_algae">
<span class="sig-prename descclassname"><span class="pre">src.validate_inputs.</span></span><span class="sig-name descname"><span class="pre">validate_snow_algae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">impurities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/validate_inputs.html#validate_snow_algae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.validate_inputs.validate_snow_algae" title="Permalink to this definition"></a></dt>
<dd><p>Validates snow algae configuration.
This includes warning the user that OPs are from literature and not yet field validated.
Most importantly, checks that the units of the absorption coefficient and the cell
concentration match up (m2/cell -&gt; cells/mL, m2/mg -&gt; ppb)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>impurities</strong> – a list of Impurity objects</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError when units mismatch</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="BioSNICAR Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tests.html" class="btn btn-neutral float-right" title="tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Joseph Cook.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>